"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[198],{9183:(e,t,n)=>{n.d(t,{hG:()=>i,ho:()=>a,sr:()=>c,ul:()=>r,zi:()=>l});var s=n(3565);const i=async(e,t)=>{const n={Authorization:`Bearer ${t}`};return s.A.post("/api/question/create",e,{headers:n})},r=(e,t)=>{const n={Authorization:`Bearer ${t}`};return s.A.delete(`/api/question/${e}`,{headers:n})},a=e=>{const t={Authorization:`Bearer ${e}`};return s.A.get("/api/question/list",{headers:t})},c=async(e,t,n)=>{const i={Authorization:`Bearer ${n}`};return s.A.put(`/api/question/${t}`,e,{headers:i})},l=async(e,t)=>{const n={Authorization:`Bearer ${t}`};return s.A.get(`/api/question/${e}`,{headers:n})}},198:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var s=n(5043),i=n(3216),r=n(861),a=n(5104),c=n(6105),l=n(1917),o=n(5917),h=n(4101),u=n(4227),d=n(4231),m=n(2303),p=n(4709),g=n(825),x=n(3805),j=n(9183),C=n(2719),f=n(9556),y=n(579);const b=()=>{const{questionId:e}=(0,i.g)(),[t,n]=(0,s.useState)(""),[b,A]=(0,s.useState)([{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null}]),[k,v]=(0,s.useState)(null),[w,U]=(0,s.useState)(localStorage.getItem("accessToken")),[$,q]=(0,s.useState)(!1),[N,B]=(0,s.useState)("");(0,s.useEffect)((()=>{e&&S(e)}),[e]),(0,s.useEffect)((()=>{if($){const e=setTimeout((()=>{q(!1)}),5e3);return()=>clearTimeout(e)}}),[$]);const S=async e=>{try{const t=(await(0,j.zi)(e,w)).data.msg.question;n(t.description),v(t.imageUrl||null);const s=(t.options||[{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null}]).map(((e,n)=>({...e,isCorrect:e._id===t.answer._id,image:e.imageUrl||null})));A(s)}catch(t){B("L\u1ed7i khi t\u1ea3i th\xf4ng tin c\xe2u h\u1ecfi"),q(!0)}},T=(e,t)=>{const n=b.map(((n,s)=>s===e?{...n,[t.target.name]:"isCorrect"===t.target.name?t.target.checked:t.target.value}:n));A(n)},D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.target.files[0];if(n){const e=new FileReader;e.onloadend=()=>{if(-1===t)v(e.result);else{const n=[...b];n[t].image=e.result,A(n)}},e.readAsDataURL(n)}},z=e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(t.length),i=new Uint8Array(s);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Blob([s],{type:n})},W=(0,y.jsxs)(C.A,{id:"popover-basic",children:[(0,y.jsx)(C.A.Header,{as:"h3",children:"H\u01b0\u1edbng d\u1eabn \u0111\u1ecbnh d\u1ea1ng"}),(0,y.jsxs)(C.A.Body,{children:[(0,y.jsx)("p",{children:"\u0110\u1ec3 paste c\xe2u h\u1ecfi, b\u1ea1n c\u1ea7n \u0111\u1ecbnh d\u1ea1ng nh\u01b0 sau:"}),(0,y.jsxs)("p",{children:["C\xe2u h\u1ecfi ho\u1eb7c m\xf4 t\u1ea3 ",(0,y.jsx)("br",{}),"A. \u0110\xe1p \xe1n 1 ",(0,y.jsx)("br",{}),"B. \u0110\xe1p \xe1n 2 ",(0,y.jsx)("br",{}),"C. \u0110\xe1p \xe1n 3 ",(0,y.jsx)("br",{}),"D. \u0110\xe1p \xe1n 4"]}),(0,y.jsx)("p",{children:"Ho\u1eb7c:"}),(0,y.jsxs)("p",{children:["C\xe2u h\u1ecfi ho\u1eb7c m\xf4 t\u1ea3 ",(0,y.jsx)("br",{}),"A. \u0110\xe1p \xe1n 1 B. \u0110\xe1p \xe1n 2 C. \u0110\xe1p \xe1n 3 D. \u0110\xe1p \xe1n 4"]})]})]});return(0,y.jsxs)(r.E,{children:[(0,y.jsx)(a.V,{children:e?"Ch\u1ec9nh s\u1eeda c\xe2u h\u1ecfi":"Th\xeam c\xe2u h\u1ecfi"}),(0,y.jsx)(c.W,{children:(0,y.jsxs)(l.q,{onSubmit:async s=>{if(s.preventDefault(),!(t.trim()?b.some((e=>!e.text.trim()))?(B("T\u1ea5t c\u1ea3 c\xe1c l\u1ef1a ch\u1ecdn ph\u1ea3i c\xf3 n\u1ed9i dung."),0):b.some((e=>e.isCorrect))||(B("Ph\u1ea3i ch\u1ecdn \xedt nh\u1ea5t m\u1ed9t \u0111\xe1p \xe1n \u0111\xfang."),0):(B("\u0110\u1ec1 b\xe0i kh\xf4ng \u0111\u01b0\u1ee3c \u0111\u1ec3 tr\u1ed1ng."),0)))return void q(!0);const i=new FormData;i.append("description",t),k&&k.startsWith("data:")&&i.append("image",z(k),"question_image.jpg");const r=b.map((e=>({text:e.text,isCorrect:e.isCorrect})));i.append("options",JSON.stringify(r));const a=b.findIndex((e=>e.isCorrect));-1!==a&&i.append("answer",a.toString()),b.forEach(((e,t)=>{e.image&&e.image.startsWith("data:")&&i.append(`options[${t}]`,z(e.image),`option_${t}_image.jpg`)}));try{let t;e?(i.append("id",e),t=await(0,j.sr)(i,e,w)):t=await(0,j.hG)(i,w),200===t.status?(B(e?"C\u1eadp nh\u1eadt c\xe2u h\u1ecfi th\xe0nh c\xf4ng!":"Th\xeam c\xe2u h\u1ecfi m\u1edbi th\xe0nh c\xf4ng!"),e&&alert("C\u1eadp nh\u1eadt c\xe2u h\u1ecfi th\xe0nh c\xf4ng!"),q(!0)):(B("\u0110\u1ea7u v\xe0o kh\xf4ng h\u1ee3p l\u1ec7"),q(!0)),e||(n(""),A([{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null},{text:"",isCorrect:!1,image:null}]),v(null))}catch(c){console.error(c),B("L\u1ed7i khi l\u01b0u c\xe2u h\u1ecfi"),q(!0)}},children:[$&&(0,y.jsx)(o.k,{color:N.startsWith("Failed")||N.startsWith("An error")?"danger":"success",children:N}),(0,y.jsxs)(h.s,{className:"mb-3",children:[(0,y.jsx)(u.U,{sm:"2",children:(0,y.jsx)("label",{htmlFor:"question-text",children:"\u0110\u1ec1 b\xe0i:"})}),(0,y.jsxs)(u.U,{sm:"6",children:[(0,y.jsx)(d.I,{id:"question-text",value:t,onChange:e=>n(e.target.value),rows:4}),k&&(0,y.jsx)("div",{className:"mt-3",children:(0,y.jsx)(m.t,{src:k,alt:"",style:{maxWidth:"100%",height:"auto"}})})]}),(0,y.jsxs)(u.U,{sm:"3",children:[(0,y.jsx)(p.Q,{color:"primary",onClick:()=>{const e=prompt("H\xe3y d\xe1n n\u1ed9i dung c\xe2u h\u1ecfi:");if(e){const t=/^(.*?)(?=(?:\s*[A-D]\.\s*))/s,s=e.match(t);if(s){const t=s[1].trim(),i=e.slice(s[0].length).trim(),r=/\s*[A-D]\.\s*([^A-D]*)/g,a=[];let c;for(;null!==(c=r.exec(i));)a.push({text:c[1].trim(),isCorrect:!1,image:null});n(t),A(a)}else B("N\u1ed9i dung d\xe1n v\xe0o kh\xf4ng \u0111\xfang \u0111\u1ecbnh d\u1ea1ng."),q(!0)}},children:"Import nhanh"}),(0,y.jsx)(f.A,{trigger:"click",placement:"right",overlay:W,children:(0,y.jsx)(p.Q,{color:"info",style:{marginLeft:"10px"},children:"?"})}),(0,y.jsx)(g.O,{className:"mt-3",type:"file",accept:"image/*",placeholder:"Th\xeam \u1ea3nh",onChange:e=>D(e)})]})]}),b.map(((e,t)=>(0,y.jsxs)(h.s,{className:"mb-3",children:[(0,y.jsx)(u.U,{sm:"2",children:(0,y.jsxs)("label",{htmlFor:`option-text-${t}`,children:["\u0110\xe1p \xe1n ",t+1,":"]})}),(0,y.jsxs)(u.U,{sm:"6",children:[(0,y.jsx)(g.O,{id:`option-text-${t}`,type:"text",name:"text",value:e.text,onChange:e=>T(t,e)}),e.image&&(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsx)(m.t,{src:e.image,alt:"",style:{maxWidth:"100%",height:"auto"}})})]}),(0,y.jsxs)(u.U,{sm:"2",className:"align-self-center",children:[(0,y.jsx)(x.C,{id:`option-correct-${t}`,label:"\u0110\xfang",name:"isCorrect",checked:e.isCorrect,onChange:e=>T(t,e)}),(0,y.jsx)(g.O,{type:"file",accept:"image/*",placeholder:"Th\xeam \u1ea3nh",onChange:e=>D(e,t)})]}),(0,y.jsx)(u.U,{sm:"2",className:"align-self-center",children:(0,y.jsx)(p.Q,{type:"button",color:"danger",onClick:()=>(e=>{A(b.filter(((t,n)=>n!==e)))})(t),children:"X\xf3a"})})]},t))),(0,y.jsx)(h.s,{className:"mb-3",children:(0,y.jsx)(u.U,{sm:"12",children:(0,y.jsx)(p.Q,{type:"button",color:"primary",onClick:()=>{A([...b,{text:"",isCorrect:!1,image:null}])},children:"Th\xeam l\u1ef1a ch\u1ecdn"})})}),(0,y.jsx)(h.s,{className:"mb-3",children:(0,y.jsx)(u.U,{sm:"12",children:(0,y.jsx)(p.Q,{type:"submit",color:"success",children:e?"C\u1eadp nh\u1eadt":"L\u01b0u"})})})]})})]})}}}]);
//# sourceMappingURL=198.d062937e.chunk.js.map