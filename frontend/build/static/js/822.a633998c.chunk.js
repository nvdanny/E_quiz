"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[822],{8590:(e,t,n)=>{n.d(t,{CB:()=>o,Dt:()=>l,I$:()=>r,JZ:()=>i,Sv:()=>a,e9:()=>u,ou:()=>m,tR:()=>d,yB:()=>c});var s=n(3565);const o=async(e,t)=>{const n={title:e.title,description:e.description,duration:e.duration,start:e.start,end:e.end,questions:e.questions},o={Authorization:`Bearer ${t}`,"Content-Type":"application/json"};return s.A.post("/api/exam/",n,{headers:o})},a=async(e,t,n)=>{const o={id:e,title:t.title,description:t.description,duration:t.duration,start:t.start,end:t.end,questions:t.questions,active:t.active},a={Authorization:`Bearer ${n}`,"Content-Type":"application/json"};return s.A.put(`/api/exam/${e}`,o,{headers:a})},r=async(e,t)=>{const n={Authorization:`Bearer ${t}`};return s.A.get(`/api/exam/${e}`,{headers:n})},i=async e=>{const t={Authorization:`Bearer ${e}`};return s.A.get("/api/exam/list",{headers:t})},l=async(e,t)=>{const n={Authorization:`Bearer ${t}`};return s.A.delete(`/api/exam/${e}`,{headers:n})},c=async(e,t,n)=>{const o={id:e,active:t},a={Authorization:`Bearer ${n}`,"Content-Type":"application/json"};return s.A.post("/api/exam/updateStatus",o,{headers:a})},d=async e=>{const t={Authorization:`Bearer ${e}`};return s.A.get("/api/submission/",{headers:t})},u=async e=>{const t={Authorization:`Bearer ${e}`};return s.A.get("/api/exam/",{headers:t})},m=async(e,t,n,o)=>{const a={id:t,answers:n,user:o},r={Authorization:`Bearer ${e}`,"Content-Type":"application/json"};return s.A.post("/api/submission/submit",a,{headers:r})}},3822:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var s=n(5043),o=n(5566),a=n(8155),r=n(8139),i=n.n(r),l=n(7852),c=n(579);const d={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},u=s.forwardRef(((e,t)=>{let{bsPrefix:n,position:s,containerPosition:o,className:a,as:r="div",...u}=e;return n=(0,l.oU)(n,"toast-container"),(0,c.jsx)(r,{ref:t,...u,className:i()(n,s&&d[s],o&&`position-${o}`,a)})}));u.displayName="ToastContainer";const m=u;var h=n(3240),x=n(8399),p=n(4830);const g={[x.ns]:"showing",[x.ze]:"showing show"},v=s.forwardRef(((e,t)=>(0,c.jsx)(p.A,{...e,ref:t,transitionClasses:g})));v.displayName="ToastFade";const f=v;var j=n(6618),y=n(5632);const b=s.createContext({onClose(){}}),A=s.forwardRef(((e,t)=>{let{bsPrefix:n,closeLabel:o="Close",closeVariant:a,closeButton:r=!0,className:d,children:u,...m}=e;n=(0,l.oU)(n,"toast-header");const h=(0,s.useContext)(b),x=(0,j.A)((e=>{null==h||null==h.onClose||h.onClose(e)}));return(0,c.jsxs)("div",{ref:t,...m,className:i()(n,d),children:[u,r&&(0,c.jsx)(y.A,{"aria-label":o,variant:a,onClick:x,"data-dismiss":"toast"})]})}));A.displayName="ToastHeader";const S=A,w=s.forwardRef(((e,t)=>{let{className:n,bsPrefix:s,as:o="div",...a}=e;return s=(0,l.oU)(s,"toast-body"),(0,c.jsx)(o,{ref:t,className:i()(n,s),...a})}));w.displayName="ToastBody";const N=w,I=s.forwardRef(((e,t)=>{let{bsPrefix:n,className:o,transition:a=f,show:r=!0,animation:d=!0,delay:u=5e3,autohide:m=!1,onClose:x,onEntered:p,onExit:g,onExiting:v,onEnter:j,onEntering:y,onExited:A,bg:S,...w}=e;n=(0,l.oU)(n,"toast");const N=(0,s.useRef)(u),I=(0,s.useRef)(x);(0,s.useEffect)((()=>{N.current=u,I.current=x}),[u,x]);const C=(0,h.A)(),B=!(!m||!r),E=(0,s.useCallback)((()=>{B&&(null==I.current||I.current())}),[B]);(0,s.useEffect)((()=>{C.set(E,N.current)}),[C,E]);const T=(0,s.useMemo)((()=>({onClose:x})),[x]),$=!(!a||!d),k=(0,c.jsx)("div",{...w,ref:t,className:i()(n,o,S&&`bg-${S}`,!$&&(r?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"});return(0,c.jsx)(b.Provider,{value:T,children:$&&a?(0,c.jsx)(a,{in:r,onEnter:j,onEntering:y,onEntered:p,onExit:g,onExiting:v,onExited:A,unmountOnExit:!0,children:k}):k})}));I.displayName="Toast";const C=Object.assign(I,{Body:N,Header:S});var B=n(3216),E=n(8590);const T=()=>{const e=(0,B.Zp)(),[t,n]=(0,s.useState)(null),[r,i]=(0,s.useState)({}),[l,d]=(0,s.useState)(null),[u,h]=(0,s.useState)(0),[x,p]=(0,s.useState)(!1),[g,v]=(0,s.useState)(!1),[f,j]=(0,s.useState)(!1),y=(0,s.useCallback)((async()=>{if(f)return;j(!0);const t=localStorage.getItem("accessToken"),n=localStorage.getItem("examId"),s=JSON.parse(localStorage.getItem("userInfo"));try{if(n){if(!(await(0,E.ou)(t,n,r,s)).data.success)throw new Error("Submission failed");localStorage.removeItem("timeFinish"),localStorage.removeItem("selectedAnswers"),localStorage.removeItem("examId"),localStorage.setItem("submitted","true"),e("/exam/finish")}}catch(i){var o,a;console.error(i),0==(null===(o=i.response)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.success)?(alert(i.response.data.error),e("/exam/finish")):e("/exam/error",{state:{error:i.message}})}finally{j(!1),p(!1)}}),[e,r,f]);(0,s.useEffect)((()=>{if(!localStorage.getItem("accessToken"))return void e("/login");if("true"===localStorage.getItem("submitted"))return void e("/exam/finish");(async()=>{try{const t=localStorage.getItem("accessToken"),s=localStorage.getItem("examId");let o;if(s){o=(await(0,E.I$)(s,t)).data.msg.foundExam}else{o=(await(0,E.e9)(t)).data.exam}if(o){n(o),localStorage.setItem("examId",o._id);const e=localStorage.getItem("timeFinish");if(e)d(parseInt(e));else{const e=Math.floor(Date.now()/1e3)+60*o.duration;d(e),localStorage.setItem("timeFinish",e.toString())}}else e("/exam/error",{state:{error:"No active exam found"}})}catch(t){console.error("Error fetching exam:",t),e("/exam/error",{state:{error:t.message}})}})();const t=JSON.parse(localStorage.getItem("selectedAnswers")||"{}");i(t)}),[e]),(0,s.useEffect)((()=>{if(!l)return;const e=setInterval((()=>{const t=Math.floor(Date.now()/1e3),n=Math.max(l-t,0);h(n),n<=0?(clearInterval(e),y()):60===n&&v(!0)}),1e3);return()=>clearInterval(e)}),[l,y]);const b=()=>p(!1),A=e=>{var t;null===(t=document.querySelectorAll(".question")[e])||void 0===t||t.scrollIntoView({behavior:"smooth"})};return(0,c.jsxs)("div",{className:"container-fluid",children:[(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("div",{id:"questions",className:"col-12 col-lg-8",children:(0,c.jsxs)("div",{id:"container",children:[t&&(0,c.jsx)("h1",{children:t.description}),(0,c.jsx)("div",{id:"question-container",children:null===t||void 0===t?void 0:t.questions.map(((e,t)=>(0,c.jsxs)("div",{className:"question",children:[(0,c.jsxs)("h5",{children:["C\xe2u ",t+1,": ",e.description]}),e.imageUrl&&"/0"!==e.imageUrl&&(0,c.jsx)("div",{className:"question-image",children:(0,c.jsx)("img",{src:e.imageUrl,alt:`H\xecnh \u1ea3nh cho c\xe2u h\u1ecfi ${t+1}`})}),e.options.map(((e,n)=>(0,c.jsxs)("div",{className:"option",children:[(0,c.jsxs)("label",{children:[(0,c.jsx)("div",{children:(0,c.jsx)("input",{type:"radio",name:`q${t}`,value:e._id,checked:r[t]===n,onChange:()=>((e,t)=>{const n={...r,[e]:t};i(n),localStorage.setItem("selectedAnswers",JSON.stringify(n))})(t,n)})}),e.text]}),e.imageUrl&&(0,c.jsx)("div",{className:"option-image",children:(0,c.jsx)("img",{src:e.imageUrl,alt:"H\xecnh \u1ea3nh cho t\xf9y ch\u1ecdn"})})]},e._id))),(0,c.jsx)("br",{})]},e._id)))})]})}),(0,c.jsx)("div",{id:"sidebar",className:"col-12 col-lg-4",children:(0,c.jsxs)("div",{id:"sidebar-content",children:[(0,c.jsxs)("div",{id:"timer",children:[(0,c.jsx)("div",{id:"timer-text",children:"Th\u1eddi gian c\xf2n l\u1ea1i:"}),(0,c.jsx)("div",{id:"timer-time",children:`${Math.floor(u/60).toString().padStart(2,"0")}:${(u%60).toString().padStart(2,"0")}`})]}),(0,c.jsx)("hr",{}),(0,c.jsx)("div",{id:"saveButton",onClick:()=>{p(!0)},children:"N\u1ed8P B\xc0I"}),(0,c.jsx)("div",{className:"note",children:"*L\u01b0u \xfd: B\u1ea1n ch\u1ec9 \u0111\u01b0\u1ee3c ho\xe0n th\xe0nh b\xe0i thi c\u1ee7a m\xecnh trong th\u1eddi gian cho ph\xe9p, qu\xe1 th\u1eddi gian quy \u0111\u1ecbnh h\u1ec7 th\u1ed1ng s\u1ebd d\xf9ng b\xe0i l\xe0m c\u1ee7a b\u1ea1n v\xe0 n\u1ed9p b\xe0i"}),(0,c.jsx)("div",{id:"question-list",children:null===t||void 0===t?void 0:t.questions.map(((e,t)=>(0,c.jsx)("div",{className:"question-number "+(void 0!==r[t]?"answered":""),onClick:()=>A(t),tabIndex:0,onKeyPress:e=>"Enter"===e.key&&A(t),role:"button","aria-label":`Go to question ${t+1}`,children:t+1},e._id)))})]})})]}),(0,c.jsx)("button",{id:"scrollToBottomBtn",title:"Cu\u1ed9n xu\u1ed1ng cu\u1ed1i trang",onClick:()=>window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),children:"N\u1ed8P B\xc0I \u2193"}),(0,c.jsxs)(o.A,{show:x,onHide:b,children:[(0,c.jsx)(o.A.Header,{closeButton:!0,children:(0,c.jsx)(o.A.Title,{children:"X\xe1c Nh\u1eadn"})}),(0,c.jsx)(o.A.Body,{children:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n n\u1ed9p b\xe0i kh\xf4ng?"}),(0,c.jsxs)(o.A.Footer,{children:[(0,c.jsx)(a.A,{variant:"secondary",onClick:b,children:"H\u1ee7y"}),(0,c.jsx)(a.A,{variant:"primary",onClick:y,children:"X\xe1c Nh\u1eadn"})]})]}),(0,c.jsx)(m,{position:"top-end",className:"p-3",children:(0,c.jsx)(C,{show:g,onClose:()=>v(!1),delay:5e3,autohide:!0,children:(0,c.jsx)(C.Body,{children:"S\u1eafp H\u1ebft gi\u1edd! B\u1ea1n n\xean n\u1ed9p b\xe0i ngay."})})})]})}},3240:(e,t,n)=>{n.d(t,{A:()=>l});var s=n(5043),o=n(6723),a=n(9109);const r=2**31-1;function i(e,t,n){const s=n-Date.now();e.current=s<=r?setTimeout(t,s):setTimeout((()=>i(e,t,n)),r)}function l(){const e=(0,o.A)(),t=(0,s.useRef)();return(0,a.A)((()=>clearTimeout(t.current))),(0,s.useMemo)((()=>{const n=()=>clearTimeout(t.current);return{set:function(s){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e()&&(n(),o<=r?t.current=setTimeout(s,o):i(t,s,Date.now()+o))},clear:n,handleRef:t}}),[])}}}]);
//# sourceMappingURL=822.a633998c.chunk.js.map